# Scheme

# Global Root Module Configuration
root:
  name: PetTrackerApp
  database:
    type: sqlite
    database: ./data/pets.db
    synchronize: true
    logging: false

  features:
    # auth: true
    cors: true
    # validation: true
    swagger: true

  # auth:
  # jwtSecret: change-this-secret-key-in-production
  # jwtExpiresIn: 1d
  # enableLocalStrategy: true
  # enableJwtStrategy: true

  globalPrefix: api
  port: 3000

modules:
  - name: Owner
    generate: [controller, service, module, entity, dto]
    authProtected: true

    entity:
      fields:
        - name: email
          type: string
          required: true
          validation: { isEmail: true }
          unique: true
          description: Owner's email address (used for login)

        - name: password
          type: string
          required: true
          validation: { minLength: 8 }
          description: Owner's login password
          # select: false # Uncomment to hide password from default queries

        - name: firstName
          type: string
          required: true
          validation: { minLength: 2, maxLength: 50 }
          description: Owner's first name

        - name: lastName
          type: string
          required: true
          validation: { minLength: 2, maxLength: 50 }
          description: Owner's last name

        - name: phone
          type: string
          required: false
          validation: { maxLength: 20 }
          description: Owner's contact phone number

      relations:
        - type: OneToMany
          model: Pet
          field: pets
          description: A list of pets belonging to this owner

  - name: Pet
    generate: [controller, service, module, entity, dto]
    authProtected: true

    entity:
      fields:
        - name: name
          description: The name of the pet
          type: string
          required: true
          validation: { minLength: 2, maxLength: 100 }

        - name: species
          description: The species of the pet
          type: enum
          enum: [dog, cat, bird, fish, reptile, other]
          required: true
          default: other

        - name: breed
          description: The pet's breed
          type: string
          required: false
          validation: { maxLength: 50 }

        - name: age
          description: The age of the pet
          type: number
          required: false
          validation: { min: 0, max: 100 }

        - name: notes
          description: Additional notes about the pet
          type: string
          required: false
          validation: { maxLength: 500 }

      relations:
        - type: ManyToOne
          model: Owner
          field: owner
          description: The owner of this pet
          onDelete: CASCADE # If the owner is deleted, delete their pets

      get_params:
        fields: ["name", "species", "breed", "age", "notes"]
        sortBy: ["name", "species", "breed", "age", "notes"]
        sortOrder: ["ASC", "DESC"]
        pagination:
          limit: 10
          page: 1
